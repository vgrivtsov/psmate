<!DOCTYPE html>
    
{% extends "layouts/layout.html" %}
{% load static %}
{% load widget_tweaks %}
{% block content %}



<style>

.remove {
  text-align: right;
  
}


.modal-tf {
  width: auto;
  margin: auto;
}


#scrollable-dropdown-menu .dropdown-menu {
    max-height: 250px;
    overflow-y: auto;
    white-space: normal;
    
    
}    

#removequali {position:absolute; top:5px; right:5px;}

.overlay-x{
  position:absolute;
  top:10px;
  right:10px;
  cursor:pointer;
}
#scrollable-dropdown-menu{
  position:relative;
}


.ui-datepicker-calendar {
  display: none;

}​

/*.tflabel {
  display: block;
  text-align: left;
  vertical-align: top;
}
.competencesbutton {
  display: block;
  text-align: left;
  vertical-align: bottom;
}*/
</style>


<div class="container py-5" style="min-height: 100vh; overflow-y: hidden;">


<div ng-app="resume_form">

<div ng-controller="ResumeItems" >


<div class="form-group py-3" >
{% if user.is_authenticated %}

<!--Panel-->

<div class="card card-body">
    <h4 class="card-title">{{ user.last_name }} {{ user.first_name }} {{ user.profiles.fl_otch }}</h4>
    <p class="card-text">Город</p>
    <div class="flex-row">
        <p>{{ user.profiles.fl_tlph_mob }}<p/>

    </div>
</div>
<!--/.Panel-->
{% else %}                
                    
<div class="card card-body">
    <h4 class="card-title">Anonymous</h4>
    <p class="card-text">homeless</p>
    <div class="flex-row">
        <p>no phone<p/>

    </div>
</div>
<!--/.Panel-->
{% endif %} 
</div>


<div ng-form  id="resumeeditform" class="jumbotron py-3" name="resumeeditform" data-ng-repeat="item in items">

<!--close workposition button -->

   <button  type="button" class="close pull-right" ng-click="removeWorkPos(item)" aria-label="Close">
   <span >&times;</span>
   </button>

   
<!--static inputs -->     
    

<div class="form-group py-3 px-4">

    
    <input type="text" id="cvcompany" class="form-form-control form-control-1 input-sm" ng-model="item.FL_cv_companyName"
           name="FL_cv_companyName"  required>
    <label>Название компании</label>

    
    <input type="text" class="form-control form-control-1 input-sm datepicker"
           ng-model="item.FL_cv_WorkStartDate" placeholder="мм/гггг" >
    <label>Начало работы</label>
    
    <input type="text" class="form-control form-control-1 input-sm datepicker"
           ng-model="item.FL_cv_WorkEndtDate" placeholder="мм/гггг" >
    <label>Окончание</label>

</div>

<script>

$(document).ready(function() {

$.datepicker.setDefaults( $.datepicker.regional[ "ru" ] );


$('.datepicker').datepicker({
    autoclose: true,
    minViewMode: 1,
    format: 'mm/yyyy'
})

});


</script>




 <!--dynamic inputs -->
{% verbatim %} 
 
 <input type="hidden" ng-model="item.Quali" value="{{item.Quali}}">
  
 
<div ng-show="quali" id="qualiseditform" class="form-horizontal" name="qualiseditform" data-ng-repeat="quali in item.Quali" >
 
 <div class="card form-group py-2 px-4">
 
<div class="col-12 text-right"> 
    <button type="button" id="removequali" ng-click="removeQuali(item.id, quali)"  class="close" aria-label="Close">
    <span aria-hidden="true">&times;</span>
    </button> 
</div>


  
 <div class="form-group" >
 <!--Select Otrasl -->  
  <label>Отрасль</label> 
  <select class="form-control mdb-select colorful-select dropdown-info" id="otraslselect"  ng-model="quali.FL_cv_Otrasl"
          ng-change="loadPS(quali.FL_cv_Otrasl.id, item.id, quali.id)" ng-options="otrasl as otrasl.name for otrasl in selectitems">
    
   <input type="hidden" ng-model="quali.FL_cv_Otrasl" value="{{quali.FL_cv_Otrasl}}">  
  </select>
  <!-- -->

 <div class="form-group " ng-show="quali.FL_cv_Otrasl" >
   
 
<label>Должность по профстандарту</label> 
<div class='input-group' id="scrollable-dropdown-menu" >
 <!--Select PS autocomplete -->  
  <input type="text" id="psdropdown" name="psdropdown" class="form-control" dropdown-danger

         ng-model="quali.FL_cv_PS"
         uib-typeahead="ps as ps.jobtitle + ' [ ПС № ' + ps.psregnum + ' - ' + ps.nameps + ' ]'
         for ps in selectps[quali.id] | orderBy:'jobtitle' | filter:$viewValue"
         typeahead-focus
         >
  
<span class="input-group-addon" ng-click="quali.FL_cv_PS=''; selectcompt[quali.id]=''">
<button class="mdb-autocomplete-clear"  style="font-size : 15px;">&times;</button> 
</span>
  <!-- -->
</div>
</div>
 
 
   <input type="hidden" ng-model="quali.FL_cv_PS" value="{{quali.FL_cv_PS}}">
   
 </div>
  
<div class="form-group" ng-show="quali.FL_cv_PS">  
<!-- <input type="hidden" ng-model="quali.FL_cv_PS_target" value="{{ pspurposekind }}">-->

<!-- <p ng-cloak>Основная цель вида проф. деятельности: {{ pspurposekind }}</p> 

-->
 
 <div class="form-group">
 
 
 </div> 

<div class="form-group">  

  <!----------------------------------------Show competences block --------------------------------------------------->
<button class="btn btn-outline-info btn-md btn-block" ng-click="loadCompt(quali.FL_cv_PS.psregnum, item.id, quali.id)">Выбрать трудовые функции</button> 


 <div class="form-control" ng-show="quali.FL_cv_TF">


  <table class="table background-color: white">
   
    <tr ng-repeat="tf in quali.FL_cv_TF" ng-switch on="$index % 3">
     
      <td ng-switch-when="0">
          <div class="card card-body">

              <label class="checkbox">   
               <input type="checkbox"  ng-model="quali.FL_cv_TF[$index].selected"/>
               {{quali.FL_cv_TF[$index].nametf}} (Код: {{quali.FL_cv_TF[$index].codetf}} )
              </label>
              <span class="competencesbutton">
                <button type="button" class="btn btn-outline-blue-grey" data-toggle="modal"
                data-target="#tfmodal_{{item.id}}_{{quali.id}}_{{quali.FL_cv_TF[$index].id}}">Компетенции</button>
              </span>   

          </div>


<!-- Competences Modal_1 -->
<!-- Competences Modal_1 -->

<div class="modal fade modal-la" id="tfmodal_{{item.id}}_{{quali.id}}_{{quali.FL_cv_TF[$index].id}}">
  <div class="modal-dialog modal-lg">
<div class="modal-content">
      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Трудовые функции</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>

      <!-- Modal body -->

 <div class="form-group">
<input type="hidden" ng-model="quali.FL_cv_LA.laboractions" value="{{quali.FL_cv_LA.laboractions}}">  <!--save to DB-->

  <table class="table table-striped">  <!-- Data split to 3  table coloumns-->
    <tr ng-repeat="la in quali.FL_cv_TF[$index].laboractions" ng-switch on="$index % 3">
      <td ng-switch-when="0"><label class="checkbox">
        <input type="checkbox"  ng-model="la.selected"/>{{la.laboraction}}
      </label></td>
      <td ng-switch-when="0"><label class="checkbox">
        <span ng-show="quali.FL_cv_TF.laboractions[$index+1]">
          <input type="checkbox"  ng-model="la.selected"/>{{la.laboraction}}
        </span>
      </label></td>
      <td ng-switch-when="0"><label class="checkbox">
        <span ng-show="quali.FL_cv_TF.laboractions[$index+2]">    
          <input type="checkbox"  ng-model="la.selected"/>{{la.laboraction}}
      </label></td>
    </tr>
  </table>

</div>
      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-blue-grey" data-dismiss="modal">Сохранить</button>
        <button type="button" class="btn btn-blue-grey" data-dismiss="modal">Отменить</button>
        
      </div>

    </div>
  </div>
</div> 

      
<!-- Competences Modal_1 end --> 
<!-- Competences Modal_1 end -->
      </td> 

      <td ng-switch-when="0">

          <div class="card card-body">

              <label class="checkbox">   
               <input type="checkbox"  ng-model="quali.FL_cv_TF[$index+1].selected"/>
               {{quali.FL_cv_TF[$index].nametf}} (Код: {{quali.FL_cv_TF[$index+1].codetf}} )
              </label>
              <span class="competencesbutton">
                <button type="button" class="btn btn-outline-blue-grey" data-toggle="modal"
                data-target="#tfmodal_{{item.id}}_{{quali.id}}_{{quali.FL_cv_TF[$index+1].id}}">Компетенции</button>
              </span>   

          </div>

<!-- Competences Modal_2 -->
<!-- Competences Modal_2 -->

<div class="modal fade modal-la" id="tfmodal_{{item.id}}_{{quali.id}}_{{quali.FL_cv_TF[$index+1].id}}">
  <div class="modal-dialog modal-lg">
<div class="modal-content">
      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Трудовые функции</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>

      <!-- Modal body -->

 <div class="form-group">
<input type="hidden" ng-model="quali.FL_cv_LA.laboractions" value="{{quali.FL_cv_LA.laboractions}}">  <!--save to DB-->

  <table class="table table-striped">
    <tr ng-repeat="la in quali.FL_cv_TF.laboractions" ng-switch on="$index % 3">
      <td ng-switch-when="0"><label class="checkbox">
        <input type="checkbox"  ng-model="quali.FL_cv_TF.laboractions[$index].selected"/>{{quali.FL_cv_TF.laboractions[$index].laboraction}}
      </label></td>
      <td ng-switch-when="0"><label class="checkbox">
        <span ng-show="quali.FL_cv_TF.laboractions[$index+1]">
          <input type="checkbox"  ng-model="quali.FL_cv_TF.laboractions[$index+1].selected"/>{{quali.FL_cv_TF.laboractions[$index+1].laboraction}}
        </span>
      </label></td>
      <td ng-switch-when="0"><label class="checkbox">
        <span ng-show="quali.FL_cv_TF.laboractions[$index+2]">    
          <input type="checkbox"  ng-model="quali.FL_cv_TF.laboractions[$index+2].selected"/>{{quali.FL_cv_TF.laboractions[$index+2].laboraction}}
      </label></td>
    </tr>
  </table>

</div>
      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-blue-grey" data-dismiss="modal">Сохранить</button>
        <button type="button" class="btn btn-blue-grey" data-dismiss="modal">Отменить</button>
        
      </div>

    </div>
  </div>
</div> 
 
      
      
<!-- Competences Modal_2 end --> 
<!-- Competences Modal_2 end -->
      </td>

      <td ng-switch-when="0">

          <div class="card card-body">

              <label class="checkbox">   
               <input type="checkbox"  ng-model="quali.FL_cv_TF[$index+2].selected"/>
               {{quali.FL_cv_TF[$index].nametf}} (Код: {{quali.FL_cv_TF[$index+2].codetf}} )
              </label>
              <span class="competencesbutton">
                <button type="button" class="btn btn-outline-blue-grey" data-toggle="modal"
                data-target="#tfmodal_{{item.id}}_{{quali.id}}_{{quali.FL_cv_TF[$index+2].id}}">Компетенции</button>
              </span>   

          </div>

<!-- Competences Modal_3 -->
<!-- Competences Modal_3 -->

<div class="modal fade modal-la" id="tfmodal_{{item.id}}_{{quali.id}}_{{quali.FL_cv_TF[$index+2].id}}">
  <div class="modal-dialog modal-lg">
<div class="modal-content">
      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Трудовые функции</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>

      <!-- Modal body -->

 <div class="form-group">
<input type="hidden" ng-model="quali.FL_cv_LA.laboractions" value="{{quali.FL_cv_LA.laboractions}}">  <!--save to DB-->

  <table class="table table-striped">
    <tr ng-repeat="la in quali.FL_cv_TF.laboractions" ng-switch on="$index % 3">
      <td ng-switch-when="0"><label class="checkbox">
        <input type="checkbox"  ng-model="quali.FL_cv_TF.laboractions[$index].selected"/>{{quali.FL_cv_TF.laboractions[$index].laboraction}}
      </label></td>
      <td ng-switch-when="0"><label class="checkbox">
        <span ng-show="quali.FL_cv_TF.laboractions[$index+1]">
          <input type="checkbox"  ng-model="quali.FL_cv_TF.laboractions[$index+1].selected"/>{{quali.FL_cv_TF.laboractions[$index+1].laboraction}}
        </span>
      </label></td>
      <td ng-switch-when="0"><label class="checkbox">
        <span ng-show="quali.FL_cv_TF.laboractions[$index+2]">    
          <input type="checkbox"  ng-model="quali.FL_cv_TF.laboractions[$index+2].selected"/>{{quali.FL_cv_TF.laboractions[$index+2].laboraction}}
      </label></td>
    </tr>
  </table>

</div>
      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-blue-grey" data-dismiss="modal">Сохранить</button>
        <button type="button" class="btn btn-blue-grey" data-dismiss="modal">Отменить</button>
        
      </div>

    </div>
  </div>
</div> 
 
     
<!-- Competences Modal_3 end --> 
<!-- Competences Modal_3 end -->
     </td>
    </tr>
  </table>



<input type="hidden" ng-model="quali.FL_cv_TF" value="{{quali.FL_cv_TF}}">


</div>
 
 
  <!----------------------------------------Show competences block END --------------------------------------------------->



 
<!-- <h4>Трудовые умения</h4>
 <div class="form-group" style="height:300px; overflow:auto; border:solid 1px #C3E4FE;">
  <div class="form-control" ng-repeat="nk in quali.FL_cv_NK" >
      <label class="checkbox">
      <input type="checkbox"  ng-model="nk.selected" value="{{ nk }}" ng-cloak/>{{ nk.NameNK }}
      </label> 
  </div>
 </div> -->

 
<!-- <h4>Необходимые знания</h4>
 <div class="form-group" style="height:300px; overflow:auto; border:solid 1px #C3E4FE;">
  <div class="form-control" ng-repeat="rs in quali.FL_cv_RS" >
      <label class="checkbox">
      <input type="checkbox"  ng-model="rs.selected" value="{{ rs }}" ng-cloak/>{{ rs.NameRS }}
      </label> 
  </div>
 </div>


 
 <h4>Необходимые навыки</h4>
 <div class="form-group" style="height:300px; overflow:auto; border:solid 1px #C3E4FE;">
  <div class="form-control" ng-repeat="la in quali.FL_cv_TF" >
      <label class="checkbox">
      <input type="checkbox"  ng-model="la.selected" value="{{ la }}" ng-cloak/>{{ la.NameLA }}
      </label> 
  </div>
 </div> 


<div class="form-group" ng-show="quali.FL_cv_OC != None">   
 <h4>Другие характеристики</h4>
 <div class="form-group" style="height:300px; overflow:auto; border:solid 1px #C3E4FE;">
  <div class="form-control" ng-repeat="oc in quali.FL_cv_OC | unique: 'NameOC'" >
      <label class="checkbox">
      <input type="checkbox"  ng-model="oc.selected" value="{{ oc }}" ng-cloak/>{{ oc.NameOC}}
      </label> 
  </div>
 </div> 
</div>-->

<div class="col-12 text-right">  
    <button class="btn btn-blue-grey btn-md" ng-click="removeQuali(item.id, quali)">Удалить квалификацию</button>
</div> 
</div> 

 </div> 
 


 


</div>  <!-- div container Qualification-->
 </div>  

<button class="btn btn-info btn-md btn-block" ng-click="addnewQuali(item.id)">Добавить квалификацию</button> 

  
</div>
 

 <div class="form-group"> 
   <button class="btn btn-blue-grey btn-md btn-block" ng-click="addnewWorkPos()">Добавить место работы</button>
   <button class="btn btn-blue-grey btn-md btn-block" ng-click="addNewEdu()">Добавить место учёбы</button>
 </div>
  

<!--<input type="hidden" name="getresume"  placeholder="getresume" id="getresume" value="@verbatim{{cvitems}}@endverbatim">-->
 <div class="form-group">
 
<input type="hidden" name="resume"  placeholder="putresume" id="resume" value="@verbatim{{items}}@endverbatim">
<button class="btn btn-blue-grey btn-md" id="resumesubmit" >Сохранить резюме</button>
 
 </div>

<button type="submit" class="btn btn-blue-grey btn-md" ng-click="getitems()">Get items</button>
</div>
</div>
</div>


{% endverbatim %} 



{% endblock %}  